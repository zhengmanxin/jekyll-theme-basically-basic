---
layout: page
title: 网络小零件
excerpt_separator: "<!--more-->"
categories:
     - 网站设计
---
# 网络小零件
## 第二章 
### 5.HTTP协议
- HTTP协议全称Hyper Text Transfer Protocol，翻译过来就是超文本传输协议，位于TCP/IP四层模型当中的应用层。

- 作用：在bai浏览器与服务器间传送文档。

- HTTP(Hyper Text Transfer Protocol) 超文本传输协议，是基于应用层(TCP/IP参考模型)的通信规范；是从Web服务器传输超文本到客户端的传输协议，无状态的传输协议；不仅能够保证正确、快速、高效的传输超文本文档，而且可以确定资源加载顺序等。

- 在Web开发中，页面缓存控制、数据传递、文档语言参数设定等等，都离不开HTTP协议。HTTP协议是整个Web应用的基础，深入理解HTTP协议，是每个PHP开发工程师必须掌握的知识。
- HTTP协议的主要特点可概括如下：
 ```
1.支持客户/服务器模式。

2.简单快速：客户向服务器请求服务时，只需传送请求方法和路径。请求方法常用的有GET、HEAD、POST。每种方法规定了客户与服务器联系的类型不同。
由于HTTP协议简单，使得HTTP服务器的程序规模小，因而通信速度很快。

3.灵活：HTTP允许传输任意类型的数据对象。正在传输的类型由Content-Type加以标记。

4.无连接：无连接的含义是限制每次连接只处理一个请求。服务器处理完客户的请求，并收到客户的应答后，即断开连接。采用这种方式可以节省传输时间。

5.无状态：HTTP协议是无状态协议。无状态是指协议对于事务处理没有记忆能力。缺少状态意味着如果后续处理需要前面的信息，则它必须重传，这样可能导致每次连接传送的数据量增大。另一方面，在服务器不需要先前信息时它的应答就较快。
```

-  HTTP协议的几个重要概念
```
1.连接(Connection)：一个传输层的实际环流，它是建立在两个相互通讯的应用程序之间。
2.消息(Message)：HTTP通讯的基本单位，包括一个结构化的八元组序列并通过连接传输。
3.请求(Request)：一个从客户端到服务器的请求信息包括应用于资源的方法、资源的标识符和协议的版本号
4.响应(Response)：一个从服务器返回的信息包括HTTP协议的版本号、请求的状态(例如“成功”或“没找到”)和文档的MIME类型。
5.资源(Resource)：由URI标识的网络数据对象或服务。
6.实体(Entity)：数据资源或来自服务资源的回映的一种特殊表示方法，它可能被包围在一个请求或响应信息中。一个实体包括实体头信息和实体的本身内容。
7.客户机(Client)：一个为发送请求目的而建立连接的应用程序。
8.用户代理(User agent)：初始化一个请求的客户机。它们是浏览器、编辑器或其它用户工具。
9.服务器(Server)：一个接受连接并对请求返回信息的应用程序。
10.源服务器(Origin server)：是一个给定资源可以在其上驻留或被创建的服务器。
11.代理(Proxy)：一个中间程序，它可以充当一个服务器，也可以充当一个客户机，为其它客户机建立请求。请求是通过可能的翻译在内部或经过传递到其它的服务器中。一个代理在发送请求信息之前，必须解释并且如果可能重写它。
代理经常作为通过防火墙的客户机端的门户，代理还可以作为一个帮助应用来通过协议处理没有被用户代理完成的请求。

12.网关(Gateway)：一个作为其它服务器中间媒介的服务器。与代理不同的是，网关接受请求就好象对被请求的资源来说它就是源服务器；发出请求的客户机并没有意识到它在同网关打交道。
网关经常作为通过防火墙的服务器端的门户，网关还可以作为一个协议翻译器以便存取那些存储在非HTTP系统中的资源。
13.通道(Tunnel)：是作为两个连接中继的中介程序。一旦激活，通道便被认为不属于HTTP通讯，尽管通道可能是被一个HTTP请求初始化的。当被中继的连接两端关闭时，通道便消失。当一个门户(Portal)必须存在或中介(Intermediary)不能解释中继的通讯时通道被经常使用。
14.缓存(Cache)：反应信息的局域存储。
```
-  HTTP协议的运作方式
HTTP协议是基于请求／响应范式的。一个客户机与服务器建立连接后，发送一个请求给服务器，请求方式的格式为，统一资源标识符、协议版本号，后边是MIME信息包括请求修饰符、客户机信息和可能的内容。服务器接到请求后，给予相应的响应信息，其格式为一个状态行包括信息的协议版本号、一个成功或错误的代码，后边是MIME信息包括服务器信息、实体信息和可能的内容。

- 当一个或多个中介出现在请求／响应链中时，情况就变得复杂一些。中介由三种：代理(Proxy)、网关(Gateway)和通道(Tunnel)。一个代理根据URI的绝对格式来接受请求，重写全部或部分消息，通过URI的标识把已格式化过的请求发送到服务器。网关是一个接收代理，作为一些其它服务器的上层，并且如果必须的话，可以把请求翻译给下层的服务器协议。一个通道作为不改变消息的两个连接之间的中继点。当通讯需要通过一个中介(例如：防火墙等)或者是中介不能识别消息的内容时，通道经常被使用。
```
HTTP服务器与HTTP客户机之间的会话如下：
1 客户机与服务器建bai立联系
与服务器建立连接，就是与SOCKET建立连接，因此要指定机器名称、资源名称
和断口号，可以通过URL来提供这些信息。URL的格式为：
HTTP：//<IP地址>/[端口号]/[路径][?<查询信息>]
资源的缺省值是INDEX或DEFAULT,断口号缺省为80.
2 客户向服务器提出请求
请求信息包括希望返回的文件名和客户机信息.客户机信息以请求头发送
给服务器,请求头包括HTTP方法和头字段.
HTTP方法常用的有GET、HEAD、POST，而PUT、DELETE、LINK、UNLINK方法
许多HTTP服务器都不使用。
头字段包括：
。DATE：请求发送的日期和时间
。PARGMA：用于向服务器传输与实现无关的信息。这个字段还用于告诉代理服
务器，要从实际服务器而不是从高速缓存取资源
。FORWARDED：可以用来追踪机器之间，而不是客户机和服务器的消息。这个字段
可以用来追踪在代理服务器之间的传递路由。
。MESSAGE_ID:用于唯一地标识消息
。ACCEPT： 通知服务器客户所能接受的数据类型和尺寸。（*/*表示可以接受
所有类型的数据。
。AOTHORIZATION：向服务器提供旁路安全保护和加密机制，若服务器
不需要这个字段，则不提供这个字段
。FROM：当客户应用程序希望想服务器提供有关其电子邮件地址时使用
。IF-MODEFIED-SINCE用于提供条件GET。如果所请求的文档自从所指定
的日期以来没有发生变化，则服务器应不发送该对象。如果所发送的日期格式不合
法，或晚于服务器的日期，服务器会忽略该字段
。BEFERRER：向服务器进行资源请求用到的对象
。MIME-VERTION：用于处理不同类型文件的MIME协议版本号
。USER-AGENT：有关发出请求的客户信息
3 服务器对请求作出应答
服务器收到一个请求，就会立刻解释请求中所用到的方法，并开始处理应答。
服务器的应答消息也包含头字段形式的报文信息。
。报文第一行是状态行，格式为 <HTTP版本号><状态代码><解释短语>
状态码是个三位数字码，分为四类：
。以2开头，表示请求被成功处理
。以3开头，表示请求被重定向
。以4开头，表示客户的请求有错
。以5开头，表示服务器不能满足请求
解释短语是对状态码的解释。
。报文还向客户返回几个头字段，如：
。STATUS CODE/REASON PHRASE
。DATE
。LAST-MODIFIED
。SERVER
。CONTENT _TYPE
。RETRY_AFTER：服务器太忙时返回这个字段
。WWW_AUTHENTICATE：当服务器的安全机制要求客户发送某中授权信息时使用该字段
。报文最后是实体信息，即客户请求得到的HTTP服务器上的资源内容。
```

### 6.URL
   - 我们在设计URL的时候，对于搜索引擎来说URL设置，最好以网站目录及文件名进行命名，同时也要考虑用户体验方面因素：
       1、URL越短越好，这样既容易被搜索引擎抓取，而且方便用户记忆这个URL；一般来说URL长度不超过1000个字母，搜索引擎是可以收录，但是几百个字母的URL对于用户，记录这个URL是很困难的，所以URL设置越短用户越容易记忆。
       2、URL中要避免太多参数，参数越多对于搜索引擎越不友好，尽量对动态的URL进行伪静态处理；
       优化一个网站的时候，经常会碰到以下情况：
        www.abc.net
        abc.net/
        www.abc.net/index.html
        这几个url可以同时访问网站首页，这样就会造成网站主域名的权重分散，对网站关键词排名会照成一定的影响，需要301把其他两个URL重定向到www.abc.net，做到URL标准化，权重会集中到主域名www.abc.net。

- 浏览器通过url访问服务器步骤

①浏览器解析出url中的服务器名称

②浏览器将服务器名称解析成ip（DNS解析）

③浏览器解析出url中的服务器端口（如果有端口的话）

④浏览器建立和web服务器的TCP连接

⑤浏览器向服务器发送http请求报文

⑥服务器向浏览器发送http响应报文

⑦关闭连接，浏览器展示响应的文档

 

- 从浏览器到服务器的访问涉及到的OSI（开放系统互联(Open System Interconnection)）层有： http 协议层，TCP 传输层， IP 网络层 ，网络特有的链路端口 数据链路层，物理网络硬件 物理层。其实共有七层，在协议层和传输层中还有表示层和会话层

- 关于OSI七层协议的详细的解释有

http://blog.csdn.net/xw20084898/article/details/39438783

 

- url通用组件：

方案、用户、密码、服务器名称、端口、资源路径、参数、查询、片段

方案有：http、ftp、smtp

用户，密码：访问服务器的时候用的凭证（一般都没有）

服务器名称：www.xxx.com/www.xxx.cn这样的域名

端口：需要访问服务器的端口

资源路径：在端口下的根路径开始寻找请求的路径，如users/login.jsp

参数：请求的参数，如type=d。与之前的路径用‘；’隔开（一般也没有）

查询：以‘？’开始，‘&’拼接多个查询条件，如？id=1&username=abc

片段：以‘#’开始，在请求回完整数据后选择显示片段名这个部分的数据。如：#drill

 

url字符集：ASCII码+转义序列集

 

url编码机制：在表示不安全字符的时候把不安全字符进行编码

如：‘%’ 编码成 %0x25, '~' 编码成 %0x7e, '  '编码成%0x20
